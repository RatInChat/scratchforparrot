<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scratch for Parrot</title>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed"></script>
    <style>
        body {
          background-color: #fff;
          font-family: sans-serif;
        }
        h1 {
          font-weight: normal;
          font-size: 140%;
        }
        .demo {
          padding: 1rem;
        }
        #blocklyDiv {
          height: 100vh;
          width: 100vw;
        }
        .code {
          background-color: #f8f8f8;
          padding: 1rem;
          margin-top: 1rem;
          white-space: pre-wrap;
          word-wrap: break-word;
        }
        .code-button {
          margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="demo">
        <div id="blocklyDiv"></div>
    </div>
    <div class="code"></div>
    <button class="code-button">Show Code</button>
    <script>
        const toolbox = {
            "kind": "flyoutToolbox",
            "contents": [
                {
                    "kind": "block",
                    "type": "controls_if"
                },
                {
                    "kind": "block",
                    "type": "logic_compare"
                },
                {
                    "kind": "block",
                    "type": "controls_repeat_ext"
                },
                {
                    "kind": "block",
                    "type": "math_number",
                    "fields": {
                        "NUM": 123
                    }
                },
                {
                    "kind": "block",
                    "type": "math_arithmetic"
                },
                {
                    "kind": "block",
                    "type": "text"
                },
                {
                    "kind": "block",
                    "type": "text_print"
                }
            ]
        };

        const blocklyDiv = document.getElementById('blocklyDiv');
        const codeDiv = document.querySelector('.code');
        const codeButton = document.querySelector('.code-button');

        const workspace = Blockly.inject(blocklyDiv, {
            toolbox: toolbox,
            grid: {
                spacing: 20,
                length: 3,
                colour: '#ccc',
                snap: true
            },
            trashcan: true,
            move: {
                scrollbars: {
                    horizontal: true,
                    vertical: true
                },
                drag: true,
                wheel: false
            },
            collapse: true
        });

        codeButton.addEventListener('click', function() {
            const jsCode = Blockly.JavaScript.workspaceToCode(workspace);
            codeDiv.textContent = jsCode;
        });
    </script>
</body>
</html>
